# 01 📚 실행 컨텍스트

<br>

## 📝 읽은 내용
실행 컨텍스트(execution context)는 실행할 코드에 제공할 환경 정보들을 모아놓은 객체이다.

### 스택(stack)
- 스택은 출입구가 하나뿐인 깊은 우물 같은 데이터 구조
- 비어있는 스택에 a,b,c,d를 저장헀다면, 꺼낼 때는 반대로 d,c,b,a의 순서대로 꺼낸다.


### 큐(queue)
- 큐는 양쪽이 모두 열려있는 파이프 구조
- 보통 한쪽은 입력만, 다른 한쪽은 출력만을 담당하는 구조다.

### 실행 컨텍스트가 실행하는 순서

```js
// ------------------------------------- (1)
var a = 1;
function outer(){
  function inner(){
    console.log(a); // undefined
    var a = 3;
  }
  inner(); // ------------------------ (2)
  console.log(a); // 1
}
outer(); // -------------------------- (2)
console.log(a); // 1
```

<p align="center">
  <img src="https://github.com/user-attachments/assets/7317bdda-b000-4a26-b09e-60e6313fbbe8" alt="image">
</p>

1. 코드가 실행되는 순간`(1)` 전역 컨텍스트가 콜 스택에 담긴다.
2. `(3)`에서 `outer` 함수를 호출하면 자바스크립트 엔진은 `outer`에 대한 환경 정보를 수집해서 `outer` 실행 컨텍스트를 생성한 후 콜 스택에 담는다.
3. `outer`실행 컨텍스트가 놓인 상태가 됐으므로 전역 컨텍스트와 관련된 코드의 실행을 일시 중단하고 대신 `outer` 함수 내부의 코드들을 순차로 실행한다.
4. 다시 `(2)`에서 inner 함수의 실행 컨텍스트가 콜 스택의 가장 위에 담기면 `outer` 컨텍스트와 관련된 코드의 실행을 중단하고 `inner` 함수 내부의 코드를 순서대로 진행한다.
5. `inner`함수 내부에서 `a` 변수에 값 3을 할당하고 나면 `inner` 함수의 실행이 종료되면서 `inner` 실행 컨텍스트가 콜 스택에서 제거된다.
6. `outer` 컨텍스트가 콜 스택의 맨 위에 존재하게 되고, 중단했던 `(2)`의 다음 줄부터 이어서 실행한다.
7. `a` 변수의 값을 출력하고 나면 `outer` 함수의 실행이 종료되어 `outer` 실행 컨텍스트가 콜 스택에서 제거되고 콜 스택에는 전역 컨텍스트만 남아 있게 된다.
8. 실행을 중단했던 `(3)`의 다음 줄부터 이어서 실행한다.
9. `a` 변수의 값을 출력하고 나면 전역 공간에 더는 실행할 코드가 남아 있지 않아 전역 컨텍스트도 제거되고, 콜 스택에는 아무것도 남지 않은 상태로 종료된다.

### 실행 컨텍스트의 용도
- 스택 구조를 잘 생각해보면 한 실행 컨텍스트가 콜 스택의 맨 위에 쌓이는 순간이 곧 현재 실행할 코드에 관여하게 되는 시점
- 이렇게 어떤 실행 컨텍스트가 활성화될 때 자바스크립트 엔진은 해당 컨텍스트에 관련된 코드들을 실행하는 데 필요한 환경 정보들을 수집해서 실행 컨테그트 객체에 저장
- 이 객체는 자바스크립트 엔진이 활용할 목적으로 생성할 뿐 개발자가 코드를 통해 확인할 수는 없다.

### 실행 컨텍스트에 담기는 정보들
1. VariableEnvironment: 현재 컨텍스트 내의 식별자들에 대한 정보 + 외부 환경 정보, 선언 시점의 LexicalEnvironment의 스냅샷으로, 변경 사항은 반영되지 않음.
2. LexicalEnvironment: 처음에는 VariableEnvironment와 같지만 변경 사항이 실시간으로 반영됨.
3. ThisBinding: `this` 식별자가 바라봐야 할 대상 객체


## 💡 인사이트
- 실행 컨텍스트는 함수 실행문에 따라 새로운 컨텍스트를 생성하여 LIFO방식으로 실행된다.
- 이러한 방식으로 스코프가 생성되며 스코프 체이닝을 형성하는 것을 알 수 있었다.
